# API å‹åŠ›æµ‹è¯•å·¥å…· - è…¾è®¯äº‘ä¸€é”®éƒ¨ç½²æ•™ç¨‹

æœ¬æ•™ç¨‹æä¾›**çœŸæ­£çš„ä¸€é”®éƒ¨ç½²**æ–¹æ¡ˆï¼Œå…¨ç¨‹è‡ªåŠ¨åŒ–ï¼Œæ— éœ€ä»»ä½•æ‰‹åŠ¨é…ç½®ã€‚

---

## éƒ¨ç½²å‰å‡†å¤‡

æ‚¨åªéœ€è¦å‡†å¤‡ä¸€å°**è…¾è®¯äº‘æœåŠ¡å™¨**ï¼Œå…¶ä»–æ‰€æœ‰é…ç½®ï¼ˆMySQLã€Nginxã€ç¯å¢ƒå˜é‡ç­‰ï¼‰éƒ½ä¼šè‡ªåŠ¨å®Œæˆã€‚

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| æ“ä½œç³»ç»Ÿ | Ubuntu 20.04 / 22.04 LTS |
| æœ€ä½é…ç½® | 2æ ¸ 4GB å†…å­˜ |
| æ¨èé…ç½® | 4æ ¸ 8GB å†…å­˜ï¼ˆé«˜å¹¶å‘å‹æµ‹ï¼‰ |

---

## ç¬¬ä¸€æ­¥ï¼šè´­ä¹°è…¾è®¯äº‘æœåŠ¡å™¨

1. ç™»å½• [è…¾è®¯äº‘æ§åˆ¶å°](https://console.cloud.tencent.com/)
2. æœç´¢"äº‘æœåŠ¡å™¨"ï¼Œç‚¹å‡»"æ–°å»º"
3. é€‰æ‹©é…ç½®ï¼š

| é…ç½®é¡¹ | é€‰æ‹© |
|--------|------|
| è®¡è´¹æ¨¡å¼ | æŒ‰é‡è®¡è´¹ï¼ˆæµ‹è¯•ï¼‰æˆ–åŒ…å¹´åŒ…æœˆï¼ˆç”Ÿäº§ï¼‰ |
| åœ°åŸŸ | é€‰æ‹©ç¦»æ‚¨æœ€è¿‘çš„åœ°åŸŸ |
| æœºå‹ | æ ‡å‡†å‹ S5ï¼Œ2æ ¸4G èµ·æ­¥ |
| é•œåƒ | **Ubuntu 22.04 LTS 64ä½** |
| ç³»ç»Ÿç›˜ | 50GB SSD |
| å¸¦å®½ | æŒ‰æµé‡è®¡è´¹ï¼Œ5Mbps |

4. è®¾ç½®ç™»å½•å¯†ç 
5. å®Œæˆè´­ä¹°

---

## ç¬¬äºŒæ­¥ï¼šé…ç½®å®‰å…¨ç»„

è´­ä¹°åéœ€è¦å¼€æ”¾ç«¯å£ï¼Œå¦åˆ™æ— æ³•è®¿é—®ï¼š

1. è¿›å…¥äº‘æœåŠ¡å™¨æ§åˆ¶å°
2. ç‚¹å‡»å·¦ä¾§"å®‰å…¨ç»„"
3. é€‰æ‹©æœåŠ¡å™¨ç»‘å®šçš„å®‰å…¨ç»„ï¼Œç‚¹å‡»"ä¿®æ”¹è§„åˆ™"
4. æ·»åŠ å…¥ç«™è§„åˆ™ï¼š

| ç«¯å£ | åè®® | æ¥æº | è¯´æ˜ |
|------|------|------|------|
| 22 | TCP | 0.0.0.0/0 | SSHè¿æ¥ |
| 80 | TCP | 0.0.0.0/0 | HTTPè®¿é—® |
| 443 | TCP | 0.0.0.0/0 | HTTPSè®¿é—® |

---

## ç¬¬ä¸‰æ­¥ï¼šä¸€é”®éƒ¨ç½²ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰

### æ–¹å¼ä¸€ï¼šåœ¨çº¿ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰

è¿æ¥åˆ°æœåŠ¡å™¨åï¼Œæ‰§è¡Œä»¥ä¸‹**ä¸€æ¡å‘½ä»¤**å³å¯å®Œæˆå…¨éƒ¨éƒ¨ç½²ï¼š

```bash
# ä¸‹è½½é¡¹ç›®å¹¶è‡ªåŠ¨éƒ¨ç½²
git clone https://github.com/æ‚¨çš„ç”¨æˆ·å/api-stress-tester.git ~/api-stress-tester && \
cd ~/api-stress-tester/scripts && \
chmod +x deploy-auto.sh && \
./deploy-auto.sh
```

### æ–¹å¼äºŒï¼šä¸Šä¼ é¡¹ç›®åéƒ¨ç½²

å¦‚æœæ‚¨å·²ç»å°†é¡¹ç›®ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/api-stress-tester/scripts

# è¿è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬
chmod +x deploy-auto.sh
./deploy-auto.sh
```

---

## éƒ¨ç½²è¿‡ç¨‹è¯´æ˜

è„šæœ¬ä¼š**è‡ªåŠ¨å®Œæˆ**ä»¥ä¸‹æ‰€æœ‰æ“ä½œï¼Œæ‚¨åªéœ€ç­‰å¾…ï¼š

| æ­¥éª¤ | è¯´æ˜ | è€—æ—¶ |
|------|------|------|
| 1 | æ›´æ–°ç³»ç»Ÿè½¯ä»¶åŒ… | ~1åˆ†é’Ÿ |
| 2 | å®‰è£… Node.js 22 | ~30ç§’ |
| 3 | å®‰è£… pnpmã€PM2 | ~20ç§’ |
| 4 | **å®‰è£… MySQL å¹¶è‡ªåŠ¨é…ç½®** | ~1åˆ†é’Ÿ |
| 5 | å®‰è£… Nginx | ~20ç§’ |
| 6 | **è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“å¯†ç å’ŒJWTå¯†é’¥** | å³æ—¶ |
| 7 | å®‰è£…é¡¹ç›®ä¾èµ– | ~2åˆ†é’Ÿ |
| 8 | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ | ~1åˆ†é’Ÿ |
| 9 | åˆå§‹åŒ–æ•°æ®åº“è¡¨ | ~10ç§’ |
| 10 | é…ç½® Nginx åå‘ä»£ç† | ~5ç§’ |
| 11 | é…ç½®é˜²ç«å¢™ | ~5ç§’ |
| 12 | å¯åŠ¨æœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯ | ~10ç§’ |

**æ€»è€—æ—¶çº¦ 5-8 åˆ†é’Ÿ**

---

## éƒ¨ç½²å®Œæˆ

éƒ¨ç½²æˆåŠŸåï¼Œæ‚¨ä¼šçœ‹åˆ°ï¼š

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                  â•‘
â•‘                    ğŸ‰ éƒ¨ç½²æˆåŠŸå®Œæˆï¼                             â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  è®¿é—®åœ°å€:  http://æ‚¨çš„æœåŠ¡å™¨IP

  æ•°æ®åº“ä¿¡æ¯:
    æ•°æ®åº“å:   api_stress_tester
    ç”¨æˆ·å:     stress_user
    å¯†ç :       xxxxxxxxxxxxxxxxï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰

  å¸¸ç”¨å‘½ä»¤:
    æŸ¥çœ‹çŠ¶æ€:   pm2 status
    æŸ¥çœ‹æ—¥å¿—:   pm2 logs api-stress-tester
    é‡å¯æœåŠ¡:   pm2 restart api-stress-tester

  é…ç½®ä¿¡æ¯å·²ä¿å­˜åˆ°:
    ~/api-stress-tester/DEPLOY_INFO.txt
```

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://æ‚¨çš„æœåŠ¡å™¨IP` å³å¯ä½¿ç”¨ï¼

---

## è‡ªåŠ¨ç”Ÿæˆçš„é…ç½®

è„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆå¹¶ä¿å­˜ä»¥ä¸‹é…ç½®ï¼Œæ— éœ€æ‚¨æ‰‹åŠ¨è®¾ç½®ï¼š

| é…ç½®é¡¹ | è¯´æ˜ |
|--------|------|
| MySQL æ•°æ®åº“ | è‡ªåŠ¨å®‰è£…å¹¶åˆ›å»ºæ•°æ®åº“ã€ç”¨æˆ· |
| æ•°æ®åº“å¯†ç  | 16ä½éšæœºå®‰å…¨å¯†ç  |
| JWT å¯†é’¥ | 64ä½éšæœºå®‰å…¨å¯†é’¥ |
| Nginx é…ç½® | è‡ªåŠ¨é…ç½®åå‘ä»£ç† |
| PM2 é…ç½® | è‡ªåŠ¨é…ç½®è¿›ç¨‹ç®¡ç†å’Œå¼€æœºè‡ªå¯ |
| é˜²ç«å¢™è§„åˆ™ | è‡ªåŠ¨å¼€æ”¾å¿…è¦ç«¯å£ |

æ‰€æœ‰æ•æ„Ÿä¿¡æ¯éƒ½ä¿å­˜åœ¨ `~/api-stress-tester/DEPLOY_INFO.txt` æ–‡ä»¶ä¸­ï¼Œè¯·å¦¥å–„ä¿ç®¡ã€‚

---

## å¸¸ç”¨æ“ä½œå‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| æŸ¥çœ‹æœåŠ¡çŠ¶æ€ | `pm2 status` |
| æŸ¥çœ‹å®æ—¶æ—¥å¿— | `pm2 logs api-stress-tester` |
| é‡å¯æœåŠ¡ | `pm2 restart api-stress-tester` |
| åœæ­¢æœåŠ¡ | `pm2 stop api-stress-tester` |
| å¯åŠ¨æœåŠ¡ | `pm2 start api-stress-tester` |
| æŸ¥çœ‹ Nginx çŠ¶æ€ | `sudo systemctl status nginx` |
| é‡è½½ Nginx | `sudo systemctl reload nginx` |

---

## é…ç½®åŸŸåï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨æœ‰åŸŸåï¼Œå¯ä»¥ç»‘å®šåˆ°æœåŠ¡å™¨ï¼š

### 1. æ·»åŠ  DNS è§£æ

åœ¨æ‚¨çš„åŸŸåæœåŠ¡å•†å¤„æ·»åŠ  A è®°å½•ï¼ŒæŒ‡å‘æœåŠ¡å™¨ IPã€‚

### 2. ä¿®æ”¹ Nginx é…ç½®

```bash
sudo nano /etc/nginx/sites-available/api-stress-tester
```

å°† `server_name` æ”¹ä¸ºæ‚¨çš„åŸŸåï¼š

```nginx
server_name your-domain.com;
```

ä¿å­˜åé‡è½½ Nginxï¼š

```bash
sudo nginx -t && sudo systemctl reload nginx
```

### 3. é…ç½® HTTPSï¼ˆå…è´¹è¯ä¹¦ï¼‰

```bash
# å®‰è£… Certbot
sudo apt install -y certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦ï¼ˆæ›¿æ¢ä¸ºæ‚¨çš„åŸŸåï¼‰
sudo certbot --nginx -d your-domain.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
sudo systemctl enable certbot.timer
```

---

## å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—ï¼š

```bash
cat /tmp/deploy-api-stress-tester.log
```

### Q2: è®¿é—®æ˜¾ç¤º 502 é”™è¯¯ï¼Ÿ

æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š

```bash
pm2 status
pm2 logs api-stress-tester --err
```

### Q3: å¦‚ä½•æ›´æ–°é¡¹ç›®ï¼Ÿ

```bash
cd ~/api-stress-tester
git pull
pnpm install
pnpm build
pm2 restart api-stress-tester
```

### Q4: å¦‚ä½•æŸ¥çœ‹æ•°æ®åº“å¯†ç ï¼Ÿ

```bash
cat ~/api-stress-tester/DEPLOY_INFO.txt
```

æˆ–æŸ¥çœ‹ç¯å¢ƒå˜é‡ï¼š

```bash
cat ~/api-stress-tester/.env
```

---

## æœåŠ¡å™¨é…ç½®æ¨è

æ ¹æ®æ‚¨çš„å‹æµ‹éœ€æ±‚é€‰æ‹©åˆé€‚çš„é…ç½®ï¼š

| ä½¿ç”¨åœºæ™¯ | æ¨èé…ç½® | é¢„ä¼°è´¹ç”¨ï¼ˆæœˆï¼‰ |
|----------|----------|----------------|
| ä¸ªäººæµ‹è¯• | 2æ ¸4G | Â¥50-100 |
| å°å›¢é˜Ÿä½¿ç”¨ | 4æ ¸8G | Â¥150-300 |
| é«˜å¹¶å‘å‹æµ‹ | 8æ ¸16G | Â¥400-800 |

---

*æ–‡æ¡£ç‰ˆæœ¬ï¼š2.0 | æ›´æ–°æ—¥æœŸï¼š2026-02-05 | ä½œè€…ï¼šManus AI*
