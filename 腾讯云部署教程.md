# API压力测试工具 - 腾讯云服务器部署教程

> 本教程提供傻瓜式操作步骤，即使是新手也能轻松完成部署。

---

## 📋 目录

1. [准备工作](#1-准备工作)
2. [购买腾讯云服务器](#2-购买腾讯云服务器)
3. [连接服务器](#3-连接服务器)
4. [一键部署（推荐）](#4-一键部署推荐)
5. [手动部署（备选）](#5-手动部署备选)
6. [配置域名（可选）](#6-配置域名可选)
7. [配置HTTPS（可选）](#7-配置https可选)
8. [常见问题](#8-常见问题)

---

## 1. 准备工作

### 需要准备的东西

| 项目 | 说明 |
|------|------|
| 腾讯云账号 | 如果没有，去 [腾讯云官网](https://cloud.tencent.com/) 注册 |
| 云服务器 | 最低配置：1核2G内存，推荐2核4G |
| 域名（可选） | 如果想用自定义域名访问 |

---

## 2. 购买腾讯云服务器

### 步骤 2.1：登录腾讯云

1. 打开 [腾讯云官网](https://cloud.tencent.com/)
2. 点击右上角「登录」
3. 使用微信扫码或账号密码登录

### 步骤 2.2：购买服务器

1. 登录后，点击顶部菜单「产品」→「云服务器」
2. 点击「立即选购」
3. 按以下配置选择：

| 配置项 | 推荐选择 |
|--------|----------|
| 计费模式 | 按量计费（测试用）或包年包月（长期用） |
| 地域 | 选择离你最近的地域 |
| 机型 | 标准型 S5 或 SA2 |
| CPU/内存 | 最低1核2G，推荐2核4G |
| 镜像 | **Ubuntu Server 22.04 LTS 64位**（推荐） |
| 系统盘 | 50GB 高性能云硬盘 |
| 公网带宽 | 按流量计费，1-10Mbps |
| 安全组 | 选择「放通22,80,443端口」 |
| 登录方式 | 设置密码（记住这个密码！） |

4. 确认配置，点击「立即购买」并完成支付

### 步骤 2.3：记录服务器信息

购买成功后，进入「控制台」→「云服务器」，记录以下信息：

- **公网IP地址**：例如 `119.xxx.xxx.xxx`
- **登录密码**：你设置的密码

---

## 3. 连接服务器

### 方法一：使用腾讯云网页终端（最简单）

1. 进入「云服务器控制台」
2. 找到你的服务器，点击右侧「登录」
3. 选择「标准登录方式」
4. 输入用户名 `root` 和你设置的密码
5. 点击「登录」

### 方法二：使用SSH工具（Windows）

1. 下载 [PuTTY](https://www.putty.org/) 或 [MobaXterm](https://mobaxterm.mobatek.net/)
2. 打开软件，输入服务器公网IP
3. 端口填 `22`
4. 点击连接，输入用户名 `root` 和密码

### 方法三：使用终端（Mac/Linux）

打开终端，输入：

```bash
ssh root@你的服务器IP
```

输入密码后即可连接。

---

## 4. 一键部署（推荐）

> 这是最简单的方式，复制粘贴命令即可完成部署！

### 步骤 4.1：上传项目文件

**方法A：使用Git（如果项目在GitHub上）**

```bash
# 安装Git
apt update && apt install -y git

# 克隆项目（替换为你的仓库地址）
git clone https://github.com/your-username/api-stress-tester.git /tmp/api-stress-tester
```

**方法B：使用SCP上传（从本地上传）**

在你的本地电脑上执行：

```bash
# 将项目打包
cd /path/to/api-stress-tester
tar -czf api-stress-tester.tar.gz .

# 上传到服务器
scp api-stress-tester.tar.gz root@你的服务器IP:/tmp/

# 连接服务器并解压
ssh root@你的服务器IP
mkdir -p /tmp/api-stress-tester
tar -xzf /tmp/api-stress-tester.tar.gz -C /tmp/api-stress-tester
```

### 步骤 4.2：运行一键部署脚本

```bash
# 进入项目目录
cd /tmp/api-stress-tester

# 给脚本执行权限
chmod +x deploy-tencent.sh

# 运行一键部署
./deploy-tencent.sh
```

等待几分钟，看到 `🎉 部署完成！` 就成功了！

### 步骤 4.3：访问网站

打开浏览器，输入：`http://你的服务器IP`

---

## 5. 手动部署（备选）

如果一键部署失败，可以按以下步骤手动部署：

### 步骤 5.1：更新系统

```bash
apt update && apt upgrade -y
```

### 步骤 5.2：安装 Node.js

```bash
# 安装 Node.js 20.x
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs

# 验证安装
node -v  # 应该显示 v20.x.x
npm -v   # 应该显示 10.x.x

# 安装 pnpm
npm install -g pnpm
```

### 步骤 5.3：安装 Nginx

```bash
apt install -y nginx
systemctl start nginx
systemctl enable nginx
```

### 步骤 5.4：上传并构建项目

```bash
# 创建项目目录
mkdir -p /var/www/api-stress-tester

# 将项目文件复制到目录（假设已上传到/tmp）
cp -r /tmp/api-stress-tester/* /var/www/api-stress-tester/

# 进入目录
cd /var/www/api-stress-tester

# 安装依赖
pnpm install

# 构建项目
pnpm build
```

### 步骤 5.5：配置 Nginx

```bash
# 创建 Nginx 配置文件
cat > /etc/nginx/sites-available/api-stress-tester << 'EOF'
server {
    listen 80;
    server_name _;
    
    root /var/www/api-stress-tester/dist/public;
    index index.html;
    
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
}
EOF

# 启用配置
ln -sf /etc/nginx/sites-available/api-stress-tester /etc/nginx/sites-enabled/
rm -f /etc/nginx/sites-enabled/default

# 测试配置
nginx -t

# 重启 Nginx
systemctl restart nginx
```

### 步骤 5.6：配置防火墙

```bash
# 开放80端口
ufw allow 80/tcp
ufw allow 443/tcp
ufw --force enable
```

---

## 6. 配置域名（可选）

如果你有自己的域名，可以按以下步骤配置：

### 步骤 6.1：添加DNS解析

1. 登录你的域名管理平台（如腾讯云DNSPod）
2. 添加一条A记录：
   - 主机记录：`@` 或 `www` 或你想要的子域名
   - 记录类型：`A`
   - 记录值：你的服务器公网IP

### 步骤 6.2：修改 Nginx 配置

```bash
# 编辑配置文件
nano /etc/nginx/sites-available/api-stress-tester

# 将 server_name _; 改为 server_name your-domain.com;

# 重启 Nginx
systemctl restart nginx
```

---

## 7. 配置HTTPS（可选）

使用免费的 Let's Encrypt 证书：

```bash
# 安装 Certbot
apt install -y certbot python3-certbot-nginx

# 申请证书（替换为你的域名）
certbot --nginx -d your-domain.com

# 按提示操作，选择自动重定向HTTP到HTTPS

# 设置自动续期
certbot renew --dry-run
```

---

## 8. 常见问题

### Q1: 访问网站显示"无法访问此网站"

**解决方案：**

1. 检查安全组是否开放80端口：
   - 登录腾讯云控制台 → 云服务器 → 安全组
   - 确保入站规则包含：TCP:80

2. 检查防火墙：
   ```bash
   ufw status
   ufw allow 80/tcp
   ```

3. 检查 Nginx 状态：
   ```bash
   systemctl status nginx
   ```

### Q2: 页面显示空白或404

**解决方案：**

1. 检查构建是否成功：
   ```bash
   ls -la /var/www/api-stress-tester/dist/public/
   # 应该能看到 index.html 文件
   ```

2. 重新构建：
   ```bash
   cd /var/www/api-stress-tester
   pnpm build
   ```

### Q3: 如何更新网站？

```bash
# 进入项目目录
cd /var/www/api-stress-tester

# 拉取最新代码（如果使用Git）
git pull

# 重新安装依赖和构建
pnpm install
pnpm build

# 重启 Nginx（可选）
systemctl restart nginx
```

### Q4: 如何查看错误日志？

```bash
# Nginx 错误日志
tail -f /var/log/nginx/error.log

# Nginx 访问日志
tail -f /var/log/nginx/access.log
```

### Q5: 服务器内存不足怎么办？

创建交换空间：

```bash
# 创建2G交换文件
fallocate -l 2G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile

# 永久生效
echo '/swapfile none swap sw 0 0' >> /etc/fstab
```

---

## 📞 需要帮助？

如果遇到问题，可以：

1. 查看 Nginx 日志定位问题
2. 检查腾讯云安全组配置
3. 确保服务器有足够的内存和磁盘空间

---

## 🎉 部署成功！

恭喜你完成了部署！现在可以通过以下地址访问你的API压力测试工具：

- **HTTP访问**：`http://你的服务器IP`
- **域名访问**：`http://你的域名`（如果配置了域名）
- **HTTPS访问**：`https://你的域名`（如果配置了SSL证书）

祝使用愉快！
